# frozen_string_literal: true

source 'https://rubygems.org'

# KairosChain MCP Server
#
# By default, KairosChain requires no external gems (Ruby standard library only).
# The gems below are OPTIONAL and enable additional features.
#
# To install optional dependencies:
#   bundle install
#
# Or install individually:
#   gem install hnswlib informers

# =============================================================================
# Optional: RAG (Semantic Search) Support
# =============================================================================
#
# These gems enable semantic/vector search for skills and knowledge.
# Without these gems, KairosChain falls back to regex-based search.
#
# Requirements:
#   - C++ compiler (for native extensions)
#   - ~90MB disk space for embedding model (downloaded on first use)
#
# Installation:
#   bundle install --with rag
#   # or
#   gem install hnswlib informers
#

group :rag, optional: true do
  # HNSW (Hierarchical Navigable Small World) for fast approximate nearest neighbor search
  # https://github.com/yoshoku/hnswlib.rb
  gem 'hnswlib', '~> 0.9'

  # ONNX-based sentence embeddings (sentence-transformers compatible)
  # https://github.com/ankane/informers
  gem 'informers', '~> 1.0'
end

# =============================================================================
# Optional: SQLite Storage Backend (Team Use)
# =============================================================================
#
# Enables SQLite-based storage for team environments with concurrent access.
# Without this gem, KairosChain uses file-based storage (default).
#
# Features:
#   - ACID transactions for data integrity
#   - Built-in locking for concurrent access
#   - WAL mode for better read/write concurrency
#
# Installation:
#   bundle install --with sqlite
#   # or
#   gem install sqlite3
#
# Configuration (in skills/config.yml):
#   storage:
#     backend: sqlite
#     sqlite:
#       path: "storage/kairos.db"
#       wal_mode: true
#

group :sqlite, optional: true do
  # SQLite3 Ruby bindings
  # https://github.com/sparklemotion/sqlite3-ruby
  gem 'sqlite3', '~> 1.6'
end

# =============================================================================
# Meeting Protocol HTTP Server (Phase 3+)
# =============================================================================
#
# Enables HTTP-based Meeting Protocol for P2P communication.
# Required for: bin/kairos_meeting_server
#
# Installation:
#   bundle install
#

# Rack - Web server interface
gem 'rack', '~> 3.0'

# Puma - High-performance, multi-threaded HTTP server
gem 'puma', '~> 6.0'

# Rack::Handler for JSON parsing
gem 'rack-contrib', '~> 2.5'

# =============================================================================
# Development Dependencies
# =============================================================================

group :development, :test do
  # Testing
  gem 'minitest', '~> 5.0'
  gem 'rake', '~> 13.0'
end
